<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Carrinho</title>
  <link rel="stylesheet" href="../css/style.css">
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #fafafa;
      margin: 0;
      padding: 0;
    }

    header, footer {
      background-color: #ff6600;
      color: white;
      text-align: center;
      padding: 10px;
    }

    main {
      max-width: 800px;
      margin: 20px auto;
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 8px rgba(0,0,0,0.2);
    }

    h2 { text-align: center; }

    .produto {
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-bottom: 1px solid #ddd;
      padding: 10px 0;
    }

    .produto img {
      width: 80px;
      height: 80px;
      object-fit: cover;
      border-radius: 8px;
    }

    .produto-info {
      flex: 1;
      margin-left: 10px;
    }

    .produto-nome {
      font-weight: bold;
    }

    .produto-preco {
      color: #555;
    }

    .btn-remover {
      background-color: red;
      color: white;
      border: none;
      border-radius: 6px;
      padding: 5px 10px;
      cursor: pointer;
    }

    .total {
      text-align: right;
      font-weight: bold;
      margin-top: 20px;
      font-size: 1.2em;
    }

    .pagamento {
      margin-top: 30px;
    }

    .cartao-detalhes {
      display: none;
      margin-top: 10px;
      border: 1px solid #ccc;
      padding: 10px;
      border-radius: 8px;
    }

    label {
      display: block;
      margin-top: 8px;
    }

    input[type="text"], input[type="number"], select {
      width: 100%;
      padding: 8px;
      border-radius: 5px;
      border: 1px solid #ccc;
    }

    .btn-finalizar {
      margin-top: 20px;
      width: 100%;
      padding: 10px;
      background-color: #28a745;
      border: none;
      border-radius: 8px;
      color: white;
      font-size: 1em;
      cursor: pointer;
    }

    .btn-finalizar:hover {
      background-color: #218838;
    }
  </style>
</head>
<body>

  <header>
    <h1>Carrinho</h1>
  </header>

  <main>
    <h2>Seus Itens</h2>
    <div id="lista-carrinho"></div>

    <p class="total">Total: R$ <span id="total">0,00</span></p>

    <div class="pagamento">
      <h3>Forma de pagamento</h3>

      <label><input type="radio" name="pagamento" value="pix"> PIX</label>
      <label><input type="radio" name="pagamento" value="boleto"> Boleto</label>
      <label><input type="radio" name="pagamento" value="cartao"> Cartão</label>

      <div class="cartao-detalhes" id="cartao-detalhes">
        <label>Tipo de cartão:</label>
        <select id="tipo-cartao">
          <option value="debito">Débito</option>
          <option value="credito">Crédito</option>
        </select>

        <label>Número do cartão:</label>
        <input type="text" id="num-cartao" placeholder="0000 0000 0000 0000">

        <label>Nome no cartão:</label>
        <input type="text" id="nome-cartao" placeholder="Nome completo">

        <label>Validade:</label>
        <input type="text" id="validade" placeholder="MM/AA">

        <label>CVV:</label>
        <input type="number" id="cvv" placeholder="123">
      </div>
    </div>

    <button class="btn-finalizar" id="finalizar">Finalizar Compra</button>
  </main>

  <footer>
    <p>© Loja Naruto</p>
  </footer>

  <script>
    // Função para carregar o carrinho
    function carregarCarrinho() {
      const lista = document.getElementById("lista-carrinho");
      const totalEl = document.getElementById("total");
      lista.innerHTML = "";

      let carrinho = JSON.parse(localStorage.getItem("carrinho")) || [];
      let total = 0;

      if (carrinho.length === 0) {
        lista.innerHTML = "<p>Seu carrinho está vazio.</p>";
        totalEl.textContent = "0,00";
        return;
      }

      carrinho.forEach((produto, index) => {
        const precoNum = parseFloat(produto.preco.replace("R$", "").replace(",", "."));
        total += precoNum;

        const div = document.createElement("div");
        div.classList.add("produto");
        div.innerHTML = `
          <img src="${produto.img}" alt="${produto.nome}">
          <div class="produto-info">
            <p class="produto-nome">${produto.nome}</p>
            <p class="produto-preco">${produto.preco}</p>
          </div>
          <button class="btn-remover" data-index="${index}">Remover</button>
        `;
        lista.appendChild(div);
      });

      totalEl.textContent = total.toFixed(2).replace(".", ",");
    }

    document.addEventListener("click", (e) => {
      if (e.target.classList.contains("btn-remover")) {
        let carrinho = JSON.parse(localStorage.getItem("carrinho")) || [];
        const index = e.target.getAttribute("data-index");
        carrinho.splice(index, 1);
        localStorage.setItem("carrinho", JSON.stringify(carrinho));
        carregarCarrinho();
      }
    });

    const pagamentoRadios = document.querySelectorAll('input[name="pagamento"]');
    const detalhesCartao = document.getElementById("cartao-detalhes");

    pagamentoRadios.forEach(radio => {
      radio.addEventListener("change", () => {
        if (radio.value === "cartao") {
          detalhesCartao.style.display = "block";
        } else {
          detalhesCartao.style.display = "none";
        }
      });
    });

    document.getElementById("finalizar").addEventListener("click", () => {
      const metodo = document.querySelector('input[name="pagamento"]:checked');
      if (!metodo) {
        alert("Selecione uma forma de pagamento!");
        return;
      }

      if (metodo.value === "cartao") {
        const numero = document.getElementById("num-cartao").value;
        const nome = document.getElementById("nome-cartao").value;
        const validade = document.getElementById("validade").value;
        const cvv = document.getElementById("cvv").value;

        if (!numero || !nome || !validade || !cvv) {
          alert("Preencha todos os dados do cartão!");
          return;
        }
      }

      alert("Compra finalizada com sucesso via " + metodo.value.toUpperCase() + "!");
      localStorage.removeItem("carrinho");
      window.location.href = "../index.html";
    });

    carregarCarrinho();
  </script>

</body>
</html>
